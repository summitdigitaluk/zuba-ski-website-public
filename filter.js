"use strict";(()=>{var u=t=>{for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},E=t=>typeof t=="object"&&!Array.isArray(t)&&t!==null;var N=t=>!!(t.prop("checked")===!0||t.is(":checked"));var U=t=>{var e=t?t.substring(1):location.search.substring(1);try{return JSON.parse('{"'+decodeURI(e).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch{return{}}};var S=()=>localStorage.getItem("enquiry")?JSON.parse(localStorage.getItem("enquiry")):(localStorage.setItem("enquiry",JSON.stringify(P)),P);var J=(t,e)=>{let o=S();o[t]=e,localStorage.setItem("enquiry",JSON.stringify(o))},V=t=>new Date(t.setHours(0,0,0,0)),le=V(new Date);var X={adults:1,children:[],doubleBeds:0,singleBeds:0,cots:0},P={activity:2,arrivalDate:!1,departureDate:!1,rooms:[X],airportTransfer:!1,mountainGuiding:!1,heliskiing:!1,skiPasses:!1,equipmentRental:!1,skiSchool:!1,client:{title:"",forename:"",surname:"",email:"",phone:""},comments:"",howHear:"",suppliers:{},whatsApp:!1};var M=t=>new Promise((e,o)=>{if(document.querySelector(`script[src="${t}"]`)){e();return}let r=document.createElement("script");r.onload=()=>{e()},r.onerror=()=>{o(new Error(`Error loading ${t}`))},r.src=t,document.body.appendChild(r)}),C=t=>new Promise((e,o)=>{if(document.querySelector(`link[href="${t}"]`)){e();return}fetch(t).then(r=>r.json()).then(r=>{e(r)}).catch(r=>o(new Error(`Error loading ${t}: ${r.message}`)))}),A=t=>{let e=t.split(".");if(e.length>=2){let o=e.pop();return[e.join("."),o]}return null};var F=t=>{$(t).each(function(){let e=$(this).text();$(this).empty().html(e)})},_=()=>{Object.keys(S().suppliers).forEach(t=>{console.log(t),$('.filter_added[data-item-id="'+t+'"]').css("opacity",1)}),K()},K=()=>{let t=Object.keys(S().suppliers).length,e=$("#enquiryCount");t>0?e.text("Complete Enquiry ("+t+")"):e.text("Make an Enquiry")};function ee(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}else return Array.from(t)}var k=!1;typeof window!="undefined"&&(B={get passive(){k=!0}},window.addEventListener("testPassive",null,B),window.removeEventListener("testPassive",null,B));var B,D=typeof window!="undefined"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1),v=[],T=!1,R=-1,x=void 0,h=void 0,b=void 0,H=function(e){return v.some(function(o){return!!(o.options.allowTouchMove&&o.options.allowTouchMove(e))})},O=function(e){var o=e||window.event;return H(o.target)||o.touches.length>1?!0:(o.preventDefault&&o.preventDefault(),!1)},te=function(e){if(b===void 0){var o=!!e&&e.reserveScrollBarGap===!0,n=window.innerWidth-document.documentElement.clientWidth;if(o&&n>0){var r=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);b=document.body.style.paddingRight,document.body.style.paddingRight=r+n+"px"}}x===void 0&&(x=document.body.style.overflow,document.body.style.overflow="hidden")},oe=function(){b!==void 0&&(document.body.style.paddingRight=b,b=void 0),x!==void 0&&(document.body.style.overflow=x,x=void 0)},re=function(){return window.requestAnimationFrame(function(){if(h===void 0){h={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left};var e=window,o=e.scrollY,n=e.scrollX,r=e.innerHeight;document.body.style.position="fixed",document.body.style.top=-o,document.body.style.left=-n,setTimeout(function(){return window.requestAnimationFrame(function(){var s=r-window.innerHeight;s&&o>=r&&(document.body.style.top=-(o+s))})},300)}})},ne=function(){if(h!==void 0){var e=-parseInt(document.body.style.top,10),o=-parseInt(document.body.style.left,10);document.body.style.position=h.position,document.body.style.top=h.top,document.body.style.left=h.left,window.scrollTo(o,e),h=void 0}},se=function(e){return e?e.scrollHeight-e.scrollTop<=e.clientHeight:!1},ie=function(e,o){var n=e.targetTouches[0].clientY-R;return H(e.target)?!1:o&&o.scrollTop===0&&n>0||se(o)&&n<0?O(e):(e.stopPropagation(),!0)},j=function(e,o){if(!e){console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");return}if(!v.some(function(r){return r.targetElement===e})){var n={targetElement:e,options:o||{}};v=[].concat(ee(v),[n]),D?re():te(o),D&&(e.ontouchstart=function(r){r.targetTouches.length===1&&(R=r.targetTouches[0].clientY)},e.ontouchmove=function(r){r.targetTouches.length===1&&ie(r,e)},T||(document.addEventListener("touchmove",O,k?{passive:!1}:void 0),T=!0))}};var W=function(e){if(!e){console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");return}v=v.filter(function(o){return o.targetElement!==e}),D&&(e.ontouchstart=null,e.ontouchmove=null,T&&v.length===0&&(document.removeEventListener("touchmove",O,k?{passive:!1}:void 0),T=!1)),D?ne():oe()};var L=(t,e)=>{if(document.getElementById(t)){let o=document.getElementById(t);j(o,{reserveScrollBarGap:!0});let n=$(o);n.find(".modal_loading").removeClass("is-loaded"),n.removeClass("is-closed").addClass("is-opening");let r=n.find(".modal_background");r.fadeIn(350),e&&e(),setTimeout(function(){n.removeClass("is-opening").addClass("is-open"),o.querySelector(".modal_content").scroll(0,0),r.on("click",function(){q(t)})},350)}},q=t=>{if(document.getElementById(t)){let e=$("#"+t);e.removeClass("is-open").addClass("is-closing"),e.find(".modal_background").fadeOut(200),setTimeout(function(){e.removeClass("is-closing").addClass("is-closed"),e.find(".modal_loading").addClass("is-loaded");let o=document.getElementById(t);W(o)},200)}},z=()=>{$("[s-modal-open]").on("click",function(){let t=$(this).attr("s-modal-open");L(t)}),$("[s-modal-close]").on("click",function(){let t=$(this).attr("s-modal-close");q(t)}),$(".modal_close").each(function(){$(this).on("click",function(t){t.preventDefault();var e=$(t.target).closest(".modal_component").attr("id");q(e)})})};var I,G=t=>{var e=document.querySelector(".filter_list");let o;I=new MutationObserver(n=>{o&&clearTimeout(o),o=setTimeout(()=>{n.forEach(r=>{t?(console.log(t),t()):console.log(t)})},750)}),I.observe(e,{attributes:!0,childList:!0,characterData:!0})};var Y=()=>{let t=o=>{let n;localStorage.getItem("suppliers")&&typeof localStorage.getItem("suppliers")!="undefined"&&E(JSON.parse(localStorage.getItem("suppliers")))===!0&&Date.now()-new Date(Number(JSON.parse(localStorage.getItem("suppliers")).lastUpdated)).getTime()<9e5?(n=JSON.parse(localStorage.getItem("suppliers")),console.log("suppliers from local",n),o(n)):C(["https://europe-west3-zuba-webflow.cloudfunctions.net/getSuppliers"]).then(r=>{n=r,console.log("suppliers from firebase",n),n.lastUpdated=Date.now().toString(),localStorage.setItem("suppliers",JSON.stringify(n)),o(n)}).catch(r=>{console.error(r)})};$('[s-modal-open="suggested"]').on("click",function(){e($(this))});let e=o=>{let n=o.attr("s-modal-open");$("#"+n).find(".modal_loading").removeClass("is-loaded"),L(n),t(s=>{s=s.details,console.log("suppliers",s);let m=S().suppliers,i=o.attr("data-item-id");if(u(s[i])===!1){let c={};c.name=s[i].name,c.resort=s[i].resort,c.url=s[i].url;let l=s[i].img,a=A(l);a!==null?(console.log("File Name:",a[0]),console.log("Extension:",a[1]),l=a[0]+"-p-500."+a[1]):console.log("Invalid Image URL"),c.img=l,c.checked=!0,m[i]=c,J("suppliers",m),$(".added_image").attr("src",c.img),$(".added_hotel").text(c.name+", "+c.resort)}let p=s[i]["related-accommodation-ref"];console.log("related",p);let d={};if($.each(p,function(c,l){console.log("value",l);let a=l,w=u(m[a])===!0,Q=u(s[a])===!1;if(w&&Q){console.log("foo");let g={};g.name=s[a].name,g.resort=s[a].resort,g.url=s[a].url,g.img=s[a].img,g.boarding=s[a].boarding,console.log("supplier",g),d[a]=g}}),console.log("enquirySuppliers",m),console.log("relatedSuppliers",d),u(d)===!1){$(".suggested_block").show(),$(".suggested_list").empty();let c=0;for(let l in d){c+=1;let a=d[l].img,w=A(a);w!==null?a=w[0]+"-p-500."+w[1]:console.log("Invalid Image URL"),$(".suggested_list").append('<div class="suggested_item" id="'+l+'"><a class="fill-link" href="'+d[l].url+'"></a><div class="suggested_figure"><img src="'+a+'" alt="'+d[l].name+'" loading="lazy" class="fill-image"><div class="shadow-overlay"></div></div><div class="suggested_body"><div class="suggested_header"><div class="filter_title"><h4 class="suggested_name">'+d[l].name+'</h4></div></div><div class="suggested_text-wrapper"><div class="filter_resort-link is-small w-inline-block"><div class="icon-1x1-xsmall w-embed"><svg aria-hidden="true" fill="currentColor" role="img" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Location</title><path d="m10 9c.6 0 1.1-.2 1.5-.6s.6-.9.6-1.5-.2-1.1-.6-1.5c-.8-.8-2.2-.8-3 0-.4.4-.6.9-.6 1.5s.2 1.1.6 1.5.9.6 1.5.6z"></path><path d="m15.7 17.7h-11.4c-.3 0-.6.1-.8.3s-.3.5-.3.8.1.6.3.8c.2.3.4.4.8.4h11.5c.3 0 .6-.1.8-.3s.3-.5.3-.8-.1-.6-.3-.8c-.3-.3-.5-.4-.9-.4z"></path><path d="m9.1 16c.1.1.3.2.4.3.2.1.3.1.5.1s.3 0 .5-.1.3-.1.4-.2c1.3-1 2.6-2.3 3.9-3.8s2-3.3 2-5.2c0-1.1-.2-2.2-.6-3-.4-.9-1-1.6-1.6-2.2-.7-.6-1.4-1-2.2-1.3-1.6-.6-3.2-.6-4.8 0-.8.1-1.6.6-2.2 1.2-.7.6-1.3 1.3-1.7 2.2s-.6 1.9-.6 3c0 1.9.7 3.6 2 5.2 1.3 1.5 2.7 2.8 4 3.8zm-3.7-9c0-.9.2-1.6.5-2.2s.7-1 1.1-1.4c.5-.4 1-.7 1.5-.8.5-.2 1-.3 1.5-.3s.9.1 1.5.3c.5.1 1 .4 1.5.8s.8.9 1.2 1.5c.3.6.5 1.3.5 2.2 0 1-.4 2.1-1.2 3.2s-1.9 2.3-3.4 3.5c-1.5-1.2-2.6-2.4-3.4-3.5-.9-1.2-1.3-2.3-1.3-3.3z"></path></svg></div><div>'+d[l].resort+"</div></div></div></div></div>")}}else $(".suggested_block").hide();$("#"+n).find(".modal_loading").addClass("is-loaded"),_()})}};var Z=()=>{z();let t=r=>{$(".filter_item").each(function(){let s=$(this),m=s.attr("data-item-id"),i=r.details[m];if(u(i)===!1){let f=i["holiday-types"];if(u(f)===!1){let y=s.find('[fs-cmsnest-collection="holiday-type"]');$.each(f,function(c,l){y.append('<div fs-cmsfilter-field="holiday-type">'+l.name+"</div>")})}let p=i["accommodation-facilities"];if(u(p)===!1){let y=s.find('[fs-cmsnest-collection="facilities"]');$.each(p,function(c,l){y.append('<div fs-cmsfilter-field="accommodation-facilities" fs-cmsfilter-match="all">'+l.name+"</div>")})}let d=i["travelling-with"];if(u(d)===!1){let y=s.find('[fs-cmsnest-collection="travelling-with"]');$.each(d,function(c,l){y.append('<div fs-cmsfilter-field="travelling-with">'+l.name+"</div>")})}}})},e=()=>{$("#results").find(".modal_loading").addClass("is-loaded")};G(e);let o=0,n=(r,s)=>{let m=f=>{$('.dev_filter-list [fs-cmsfilter-field="holiday-type"]').length===0&&$('.dev_filter-list [fs-cmsfilter-field="accommodation-facilities"]').length===0&&$('.dev_filter-list [fs-cmsfilter-field="travelling-with"]').length===0&&t(f),r.name!=="nestCms"&&r(f),M("https://cdn.jsdelivr.net/npm/@finsweet/attributes-cmsfilter@1/cmsfilter.js").then(()=>{o<1?setTimeout(()=>{I&&I.disconnect(),o=o+1,e(),s&&$("#"+s).find(".modal_loading").addClass("is-loaded")},750):s&&(e(),$("#"+s).find(".modal_loading").addClass("is-loaded"))}).catch(p=>{console.error(p)})};o<1&&(Webflow.require("lottie").lottie.stop(),Webflow.require("lottie").lottie.play(),$("#results").find(".modal_loading").removeClass("is-loaded")),s&&$("#"+s).find(".modal_loading").removeClass("is-loaded");let i;localStorage.getItem("suppliers")&&typeof localStorage.getItem("suppliers")!="undefined"&&E(JSON.parse(localStorage.getItem("suppliers")))===!0&&Date.now()-new Date(Number(JSON.parse(localStorage.getItem("suppliers")).lastUpdated)).getTime()<15*60*1e3?(i=JSON.parse(localStorage.getItem("suppliers")),m(i)):C(["https://europe-west3-zuba-webflow.cloudfunctions.net/getSuppliers"]).then(f=>{i=f,i.lastUpdated=Date.now().toString(),localStorage.setItem("suppliers",JSON.stringify(i)),m(i)}).catch(f=>{console.error(f)})};$('[s-modal-open="filter"]').on("click",function(){n(t,"filter")}),$(".filter-tabs_item[data-filter]").on("click",function(){n(t);let r=$(this);r.hasClass("is-active")&&r.removeClass("is-active"),$('input[data-filter="'+r.attr("data-filter")+'"]').trigger("click")}),u(U())===!1&&n(t),Y(),_()};window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{F(".filter_svg-code"),$('[name="checkbox-holiday-type"][data-filter]').on("change",function(){let t=$(this),e=$('.filter-tabs_item[data-filter="'+t.attr("data-filter")+'"]');N(t)?e.hasClass("is-active")||e.addClass("is-active"):e.removeClass("is-active")}),$(".filter-tabs_count").text($(".filter_item").length),function(){var t=document.querySelector('[fs-cmsfilter-element="results-count"]'),e=new MutationObserver(function(o){$(".filter-tabs_count").text(t.innerText)});e.observe(t,{attributes:!0,childList:!0,characterData:!0})}(),Z()});})();
